import{z as e,A as t,B as a,C as s,D as n,E as r,f as o,g as i,w as c,F as f,G as l,H as b,k as d,q as u,I as h,v as m,x as p,J as y,K as g,h as _,L as D,i as S,t as w,p as v,M,N as $,O as x,P as k,Q as T,R as Y,S as C,T as I,U as B,V as R,W as O,X as H,d as A,r as L}from"./index-1d0f9abe.js";import{_ as N}from"./u-button.82c84377.js";import{_ as P,a as z,P as E}from"./index.7425340c.js";import{_ as F}from"./u-safe-bottom.66eab0ea.js";const U={props:{show:{type:Boolean,default:()=>e.transition.show},mode:{type:String,default:()=>e.transition.mode},duration:{type:[String,Number],default:()=>e.transition.duration},timingFunction:{type:String,default:()=>e.transition.timingFunction}}},W=e=>({enter:`u-${e}-enter u-${e}-enter-active`,"enter-to":`u-${e}-enter-to u-${e}-enter-active`,leave:`u-${e}-leave u-${e}-leave-active`,"leave-to":`u-${e}-leave-to u-${e}-leave-active`}),V={methods:{clickHandler(){this.$emit("click")},async vueEnter(){const e=W(this.mode);this.status="enter",this.$emit("beforeEnter"),this.inited=!0,this.display=!0,this.classes=e.enter,await t(),await a(20),this.$emit("enter"),this.transitionEnded=!1,this.$emit("afterEnter"),this.classes=e["enter-to"]},async vueLeave(){if(!this.display)return;const e=W(this.mode);this.status="leave",this.$emit("beforeLeave"),this.classes=e.leave,await t(),this.transitionEnded=!1,this.$emit("leave"),setTimeout(this.onTransitionEnd,this.duration),this.classes=e["leave-to"]},onTransitionEnd(){this.transitionEnded||(this.transitionEnded=!0,this.$emit("leave"===this.status?"afterLeave":"afterEnter"),!this.show&&this.display&&(this.display=!1,this.inited=!1))}}};const Z=P({name:"u-transition",data:()=>({inited:!1,viewStyle:{},status:"",transitionEnded:!1,display:!1,classes:""}),emits:["click","beforeEnter","enter","afterEnter","beforeLeave","leave","afterLeave"],computed:{mergeStyle(){const{viewStyle:e,customStyle:t}=this;return{transitionDuration:`${this.duration}ms`,transitionTimingFunction:this.timingFunction,...s(t),...e}}},mixins:[n,r,V,U],watch:{show:{handler(e){e?this.vueEnter():this.vueLeave()},immediate:!0}}},[["render",function(e,t,a,s,n,r){const h=u;return n.inited?(o(),i(h,{key:0,class:l(["u-transition",n.classes]),ref:"u-transition",onClick:e.clickHandler,style:b([r.mergeStyle]),onTouchmove:e.noop},{default:c((()=>[f(e.$slots,"default",{},void 0,!0)])),_:3},8,["onClick","class","style","onTouchmove"])):d("v-if",!0)}],["__scopeId","data-v-6b30dca1"]]);const G=P({name:"u-overlay",mixins:[n,r,{props:{show:{type:Boolean,default:()=>e.overlay.show},zIndex:{type:[String,Number],default:()=>e.overlay.zIndex},duration:{type:[String,Number],default:()=>e.overlay.duration},opacity:{type:[String,Number],default:()=>e.overlay.opacity}}}],computed:{overlayStyle(){const e={position:"fixed",top:0,left:0,right:0,zIndex:this.zIndex,bottom:0,"background-color":`rgba(0, 0, 0, ${this.opacity})`};return h(e,s(this.customStyle))}},emits:["click"],methods:{clickHandler(){this.$emit("click")}}},[["render",function(e,t,a,s,n,r){const l=m(p("u-transition"),Z);return o(),i(l,{show:e.show,"custom-class":"u-overlay",duration:e.duration,"custom-style":r.overlayStyle,onClick:r.clickHandler},{default:c((()=>[f(e.$slots,"default",{},void 0,!0)])),_:3},8,["show","duration","custom-style","onClick"])}],["__scopeId","data-v-c2fb8797"]]);const j=P({name:"u-status-bar",mixins:[n,r,{props:{bgColor:{type:String,default:()=>e.statusBar.bgColor}}}],data:()=>({}),computed:{style(){const e={};return e.height=y(g().statusBarHeight,"px"),e.backgroundColor=this.bgColor,h(e,s(this.customStyle))}}},[["render",function(e,t,a,s,n,r){const l=u;return o(),i(l,{style:b([r.style]),class:"u-status-bar"},{default:c((()=>[f(e.$slots,"default",{},void 0,!0)])),_:3},8,["style"])}],["__scopeId","data-v-236c63b7"]]);const J=P({name:"u-popup",mixins:[n,r,{props:{show:{type:Boolean,default:()=>e.popup.show},overlay:{type:Boolean,default:()=>e.popup.overlay},mode:{type:String,default:()=>e.popup.mode},duration:{type:[String,Number],default:()=>e.popup.duration},closeable:{type:Boolean,default:()=>e.popup.closeable},overlayStyle:{type:[Object,String],default:()=>e.popup.overlayStyle},closeOnClickOverlay:{type:Boolean,default:()=>e.popup.closeOnClickOverlay},zIndex:{type:[String,Number],default:()=>e.popup.zIndex},safeAreaInsetBottom:{type:Boolean,default:()=>e.popup.safeAreaInsetBottom},safeAreaInsetTop:{type:Boolean,default:()=>e.popup.safeAreaInsetTop},closeIconPos:{type:String,default:()=>e.popup.closeIconPos},round:{type:[Boolean,String,Number],default:()=>e.popup.round},zoom:{type:Boolean,default:()=>e.popup.zoom},bgColor:{type:String,default:()=>e.popup.bgColor},overlayOpacity:{type:[Number,String],default:()=>e.popup.overlayOpacity}}}],data(){return{overlayDuration:this.duration+50}},watch:{show(e,t){}},computed:{transitionStyle(){const e={zIndex:this.zIndex,position:"fixed",display:"flex"};return e[this.mode]=0,"left"===this.mode||"right"===this.mode?h(e,{bottom:0,top:0}):"top"===this.mode||"bottom"===this.mode?h(e,{left:0,right:0}):"center"===this.mode?h(e,{alignItems:"center","justify-content":"center",top:0,left:0,right:0,bottom:0}):void 0},contentStyle(){const e={};if(g(),"center"!==this.mode&&(e.flex=1),this.bgColor&&(e.backgroundColor=this.bgColor),this.round){const t=y(this.round);"top"===this.mode?(e.borderBottomLeftRadius=t,e.borderBottomRightRadius=t):"bottom"===this.mode?(e.borderTopLeftRadius=t,e.borderTopRightRadius=t):"center"===this.mode&&(e.borderRadius=t)}return h(e,s(this.customStyle))},position(){return"center"===this.mode?this.zoom?"fade-zoom":"fade":"left"===this.mode?"slide-left":"right"===this.mode?"slide-right":"bottom"===this.mode?"slide-up":"top"===this.mode?"slide-down":void 0}},emits:["open","close","click"],methods:{overlayClick(){this.closeOnClickOverlay&&this.$emit("close")},close(e){this.$emit("close")},afterEnter(){this.$emit("open")},clickHandler(){"center"===this.mode&&this.overlayClick(),this.$emit("click")}}},[["render",function(e,t,a,s,n,r){const h=m(p("u-overlay"),G),y=m(p("u-status-bar"),j),g=m(p("u-icon"),z),S=u,w=m(p("u-safe-bottom"),F),v=m(p("u-transition"),Z);return o(),i(S,{class:"u-popup"},{default:c((()=>[e.overlay?(o(),i(h,{key:0,show:e.show,onClick:r.overlayClick,duration:n.overlayDuration,customStyle:e.overlayStyle,opacity:e.overlayOpacity},null,8,["show","onClick","duration","customStyle","opacity"])):d("v-if",!0),_(v,{show:e.show,customStyle:r.transitionStyle,mode:r.position,duration:e.duration,onAfterEnter:r.afterEnter,onClick:r.clickHandler},{default:c((()=>[_(S,{class:"u-popup__content",style:b([r.contentStyle]),onClick:D(e.noop,["stop"])},{default:c((()=>[e.safeAreaInsetTop?(o(),i(y,{key:0})):d("v-if",!0),f(e.$slots,"default",{},void 0,!0),e.closeable?(o(),i(S,{key:1,onClick:D(r.close,["stop"]),class:l(["u-popup__content__close",["u-popup__content__close--"+e.closeIconPos]]),"hover-class":"u-popup__content__close--hover","hover-stay-time":"150"},{default:c((()=>[_(g,{name:"close",color:"#909399",size:"18",bold:""})])),_:1},8,["onClick","class"])):d("v-if",!0),e.safeAreaInsetBottom?(o(),i(w,{key:2})):d("v-if",!0)])),_:3},8,["style","onClick"])])),_:3},8,["show","customStyle","mode","duration","onAfterEnter","onClick"])])),_:3})}],["__scopeId","data-v-ce77b006"]]);const q=P({name:"u-calendar-header",mixins:[n,r],props:{title:{type:String,default:""},subtitle:{type:String,default:""},showTitle:{type:Boolean,default:!0},showSubtitle:{type:Boolean,default:!0}},data:()=>({}),methods:{name(){}}},[["render",function(e,t,a,s,n,r){const f=v,l=u;return o(),i(l,{class:"u-calendar-header u-border-bottom"},{default:c((()=>[a.showTitle?(o(),i(f,{key:0,class:"u-calendar-header__title"},{default:c((()=>[S(w(a.title),1)])),_:1})):d("v-if",!0),a.showSubtitle?(o(),i(f,{key:1,class:"u-calendar-header__subtitle"},{default:c((()=>[S(w(a.subtitle),1)])),_:1})):d("v-if",!0),_(l,{class:"u-calendar-header__weekdays"},{default:c((()=>[_(f,{class:"u-calendar-header__weekdays__weekday"},{default:c((()=>[S("一")])),_:1}),_(f,{class:"u-calendar-header__weekdays__weekday"},{default:c((()=>[S("二")])),_:1}),_(f,{class:"u-calendar-header__weekdays__weekday"},{default:c((()=>[S("三")])),_:1}),_(f,{class:"u-calendar-header__weekdays__weekday"},{default:c((()=>[S("四")])),_:1}),_(f,{class:"u-calendar-header__weekdays__weekday"},{default:c((()=>[S("五")])),_:1}),_(f,{class:"u-calendar-header__weekdays__weekday"},{default:c((()=>[S("六")])),_:1}),_(f,{class:"u-calendar-header__weekdays__weekday"},{default:c((()=>[S("日")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-5a5ee8bd"]]);var Q=1e3,K=6e4,X=36e5,ee="millisecond",te="second",ae="minute",se="hour",ne="day",re="week",oe="month",ie="quarter",ce="year",fe="date",le="Invalid Date",be=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,de=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;const ue={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],a=e%100;return"["+e+(t[(a-20)%10]||t[a]||t[0])+"]"}};var he=function(e,t,a){var s=String(e);return!s||s.length>=t?e:""+Array(t+1-s.length).join(a)+e};const me={s:he,z:function(e){var t=-e.utcOffset(),a=Math.abs(t),s=Math.floor(a/60),n=a%60;return(t<=0?"+":"-")+he(s,2,"0")+":"+he(n,2,"0")},m:function e(t,a){if(t.date()<a.date())return-e(a,t);var s=12*(a.year()-t.year())+(a.month()-t.month()),n=t.clone().add(s,oe),r=a-n<0,o=t.clone().add(s+(r?-1:1),oe);return+(-(s+(a-n)/(r?n-o:o-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:oe,y:ce,w:re,d:ne,D:fe,h:se,m:ae,s:te,ms:ee,Q:ie}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};var pe="en",ye={};ye[pe]=ue;var ge="$isDayjsObject",_e=function(e){return e instanceof ve||!(!e||!e[ge])},De=function e(t,a,s){var n;if(!t)return pe;if("string"==typeof t){var r=t.toLowerCase();ye[r]&&(n=r),a&&(ye[r]=a,n=r);var o=t.split("-");if(!n&&o.length>1)return e(o[0])}else{var i=t.name;ye[i]=t,n=i}return!s&&n&&(pe=n),n||!s&&pe},Se=function(e,t){if(_e(e))return e.clone();var a="object"==typeof t?t:{};return a.date=e,a.args=arguments,new ve(a)},we=me;we.l=De,we.i=_e,we.w=function(e,t){return Se(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var ve=function(){function e(e){this.$L=De(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[ge]=!0}var t=e.prototype;return t.parse=function(e){this.$d=function(e){var t=e.date,a=e.utc;if(null===t)return new Date(NaN);if(we.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var s=t.match(be);if(s){var n=s[2]-1||0,r=(s[7]||"0").substring(0,3);return a?new Date(Date.UTC(s[1],n,s[3]||1,s[4]||0,s[5]||0,s[6]||0,r)):new Date(s[1],n,s[3]||1,s[4]||0,s[5]||0,s[6]||0,r)}}return new Date(t)}(e),this.init()},t.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},t.$utils=function(){return we},t.isValid=function(){return!(this.$d.toString()===le)},t.isSame=function(e,t){var a=Se(e);return this.startOf(t)<=a&&a<=this.endOf(t)},t.isAfter=function(e,t){return Se(e)<this.startOf(t)},t.isBefore=function(e,t){return this.endOf(t)<Se(e)},t.$g=function(e,t,a){return we.u(e)?this[t]:this.set(a,e)},t.unix=function(){return Math.floor(this.valueOf()/1e3)},t.valueOf=function(){return this.$d.getTime()},t.startOf=function(e,t){var a=this,s=!!we.u(t)||t,n=we.p(e),r=function(e,t){var n=we.w(a.$u?Date.UTC(a.$y,t,e):new Date(a.$y,t,e),a);return s?n:n.endOf(ne)},o=function(e,t){return we.w(a.toDate()[e].apply(a.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(t)),a)},i=this.$W,c=this.$M,f=this.$D,l="set"+(this.$u?"UTC":"");switch(n){case ce:return s?r(1,0):r(31,11);case oe:return s?r(1,c):r(0,c+1);case re:var b=this.$locale().weekStart||0,d=(i<b?i+7:i)-b;return r(s?f-d:f+(6-d),c);case ne:case fe:return o(l+"Hours",0);case se:return o(l+"Minutes",1);case ae:return o(l+"Seconds",2);case te:return o(l+"Milliseconds",3);default:return this.clone()}},t.endOf=function(e){return this.startOf(e,!1)},t.$set=function(e,t){var a,s=we.p(e),n="set"+(this.$u?"UTC":""),r=(a={},a[ne]=n+"Date",a[fe]=n+"Date",a[oe]=n+"Month",a[ce]=n+"FullYear",a[se]=n+"Hours",a[ae]=n+"Minutes",a[te]=n+"Seconds",a[ee]=n+"Milliseconds",a)[s],o=s===ne?this.$D+(t-this.$W):t;if(s===oe||s===ce){var i=this.clone().set(fe,1);i.$d[r](o),i.init(),this.$d=i.set(fe,Math.min(this.$D,i.daysInMonth())).$d}else r&&this.$d[r](o);return this.init(),this},t.set=function(e,t){return this.clone().$set(e,t)},t.get=function(e){return this[we.p(e)]()},t.add=function(e,t){var a,s=this;e=Number(e);var n=we.p(t),r=function(t){var a=Se(s);return we.w(a.date(a.date()+Math.round(t*e)),s)};if(n===oe)return this.set(oe,this.$M+e);if(n===ce)return this.set(ce,this.$y+e);if(n===ne)return r(1);if(n===re)return r(7);var o=(a={},a[ae]=K,a[se]=X,a[te]=Q,a)[n]||1,i=this.$d.getTime()+e*o;return we.w(i,this)},t.subtract=function(e,t){return this.add(-1*e,t)},t.format=function(e){var t=this,a=this.$locale();if(!this.isValid())return a.invalidDate||le;var s=e||"YYYY-MM-DDTHH:mm:ssZ",n=we.z(this),r=this.$H,o=this.$m,i=this.$M,c=a.weekdays,f=a.months,l=a.meridiem,b=function(e,a,n,r){return e&&(e[a]||e(t,s))||n[a].slice(0,r)},d=function(e){return we.s(r%12||12,e,"0")},u=l||function(e,t,a){var s=e<12?"AM":"PM";return a?s.toLowerCase():s};return s.replace(de,(function(e,s){return s||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return we.s(t.$y,4,"0");case"M":return i+1;case"MM":return we.s(i+1,2,"0");case"MMM":return b(a.monthsShort,i,f,3);case"MMMM":return b(f,i);case"D":return t.$D;case"DD":return we.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return b(a.weekdaysMin,t.$W,c,2);case"ddd":return b(a.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(r);case"HH":return we.s(r,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return u(r,o,!0);case"A":return u(r,o,!1);case"m":return String(o);case"mm":return we.s(o,2,"0");case"s":return String(t.$s);case"ss":return we.s(t.$s,2,"0");case"SSS":return we.s(t.$ms,3,"0");case"Z":return n}return null}(e)||n.replace(":","")}))},t.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},t.diff=function(e,t,a){var s,n=this,r=we.p(t),o=Se(e),i=(o.utcOffset()-this.utcOffset())*K,c=this-o,f=function(){return we.m(n,o)};switch(r){case ce:s=f()/12;break;case oe:s=f();break;case ie:s=f()/3;break;case re:s=(c-i)/6048e5;break;case ne:s=(c-i)/864e5;break;case se:s=c/X;break;case ae:s=c/K;break;case te:s=c/Q;break;default:s=c}return a?s:we.a(s)},t.daysInMonth=function(){return this.endOf(oe).$D},t.$locale=function(){return ye[this.$L]},t.locale=function(e,t){if(!e)return this.$L;var a=this.clone(),s=De(e,t,!0);return s&&(a.$L=s),a},t.clone=function(){return we.w(this.$d,this)},t.toDate=function(){return new Date(this.valueOf())},t.toJSON=function(){return this.isValid()?this.toISOString():null},t.toISOString=function(){return this.$d.toISOString()},t.toString=function(){return this.$d.toUTCString()},e}(),Me=ve.prototype;Se.prototype=Me,[["$ms",ee],["$s",te],["$m",ae],["$H",se],["$W",ne],["$M",oe],["$y",ce],["$D",fe]].forEach((function(e){Me[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),Se.extend=function(e,t){return e.$i||(e(t,ve,Se),e.$i=!0),Se},Se.locale=De,Se.isDayjs=_e,Se.unix=function(e){return Se(1e3*e)},Se.en=ye[pe],Se.Ls=ye,Se.p={};const $e={name:"u-calendar-month",mixins:[n,r],props:{showMark:{type:Boolean,default:!0},color:{type:String,default:"#3c9cff"},months:{type:Array,default:()=>[]},mode:{type:String,default:"single"},rowHeight:{type:[String,Number],default:58},maxCount:{type:[String,Number],default:1/0},startText:{type:String,default:"开始"},endText:{type:String,default:"结束"},defaultDate:{type:[Array,String,Date],default:null},minDate:{type:[String,Number],default:0},maxDate:{type:[String,Number],default:0},maxMonth:{type:[String,Number],default:2},readonly:{type:Boolean,default:()=>e.calendar.readonly},maxRange:{type:[Number,String],default:1/0},rangePrompt:{type:String,default:""},showRangePrompt:{type:Boolean,default:!0},allowSameDay:{type:Boolean,default:!1}},data:()=>({width:0,item:{},selected:[]}),watch:{selectedChange:{immediate:!0,handler(e){this.setDefaultDate()}}},computed:{selectedChange(){return[this.minDate,this.maxDate,this.defaultDate]},dayStyle(e,t,a){return(e,t,a)=>{const s={};let n=a.week;const r=Number(parseFloat(this.width/7).toFixed(3).slice(0,-1));return s.height=y(this.rowHeight),0===t&&(n=(0===n?7:n)-1,s.marginLeft=y(n*r)),"range"===this.mode&&(s.paddingLeft=0,s.paddingRight=0,s.paddingBottom=0,s.paddingTop=0),s}},daySelectStyle(){return(e,t,a)=>{let s=Se(a.date).format("YYYY-MM-DD"),n={};if(this.selected.some((e=>this.dateSame(e,s)))&&(n.backgroundColor=this.color),"single"===this.mode)s===this.selected[0]&&(n.borderTopLeftRadius="3px",n.borderBottomLeftRadius="3px",n.borderTopRightRadius="3px",n.borderBottomRightRadius="3px");else if("range"===this.mode)if(this.selected.length>=2){const e=this.selected.length-1;this.dateSame(s,this.selected[0])&&(n.borderTopLeftRadius="3px",n.borderBottomLeftRadius="3px"),this.dateSame(s,this.selected[e])&&(n.borderTopRightRadius="3px",n.borderBottomRightRadius="3px"),Se(s).isAfter(Se(this.selected[0]))&&Se(s).isBefore(Se(this.selected[e]))&&(n.backgroundColor=M(this.color,"#ffffff",100)[90],n.opacity=.7)}else 1===this.selected.length&&(n.borderTopLeftRadius="3px",n.borderBottomLeftRadius="3px");else this.selected.some((e=>this.dateSame(e,s)))&&(n.borderTopLeftRadius="3px",n.borderBottomLeftRadius="3px",n.borderTopRightRadius="3px",n.borderBottomRightRadius="3px");return n}},textStyle(){return e=>{const t=Se(e.date).format("YYYY-MM-DD"),a={};if(this.selected.some((e=>this.dateSame(e,t)))&&(a.color="#ffffff"),"range"===this.mode){const e=this.selected.length-1;Se(t).isAfter(Se(this.selected[0]))&&Se(t).isBefore(Se(this.selected[e]))&&(a.color=this.color)}return a}},getBottomInfo(){return(e,t,a)=>{const s=Se(a.date).format("YYYY-MM-DD"),n=a.bottomInfo;if("range"===this.mode&&this.selected.length>0){if(1===this.selected.length)return this.dateSame(s,this.selected[0])?this.startText:n;{const e=this.selected.length-1;return this.dateSame(s,this.selected[0])&&this.dateSame(s,this.selected[1])&&1===e?`${this.startText}/${this.endText}`:this.dateSame(s,this.selected[0])?this.startText:this.dateSame(s,this.selected[e])?this.endText:n}}return n}}},mounted(){this.init()},methods:{init(){this.$emit("monthSelected",this.selected),this.$nextTick((()=>{a(10).then((()=>{this.getWrapperWidth(),this.getMonthRect()}))}))},dateSame:(e,t)=>Se(e).isSame(Se(t)),getWrapperWidth(){this.$uGetRect(".u-calendar-month-wrapper").then((e=>{this.width=e.width}))},getMonthRect(){const e=this.months.map(((e,t)=>this.getMonthRectByPromise(`u-calendar-month-${t}`)));Promise.all(e).then((e=>{let t=1;const a=[];for(let s=0;s<this.months.length;s++)a[s]=t,t+=e[s].height;this.$emit("updateMonthTop",a)}))},getMonthRectByPromise(e){return new Promise((t=>{this.$uGetRect(`.${e}`).then((e=>{t(e)}))}))},clickHandler(e,t,a){if(this.readonly)return;this.item=a;const s=Se(a.date).format("YYYY-MM-DD");if(a.disabled)return;let n=$(this.selected);if("single"===this.mode)n=[s];else if("multiple"===this.mode)if(n.some((e=>this.dateSame(e,s)))){const e=n.findIndex((e=>e===s));n.splice(e,1)}else n.length<this.maxCount&&n.push(s);else if(0===n.length||n.length>=2)n=[s];else if(1===n.length){const e=n[0];if(Se(s).isBefore(e))n=[s];else if(Se(s).isAfter(e)){if(Se(Se(s).subtract(this.maxRange,"day")).isAfter(Se(n[0]))&&this.showRangePrompt)return void(this.rangePrompt?x(this.rangePrompt):x(`选择天数不能超过 ${this.maxRange} 天`));n.push(s);const e=n[0],t=n[1],a=[];let r=0;do{a.push(Se(e).add(r,"day").format("YYYY-MM-DD")),r++}while(Se(e).add(r,"day").isBefore(Se(t)));a.push(t),n=a}else{if(n[0]===s&&!this.allowSameDay)return;n.push(s)}}this.setSelected(n)},setDefaultDate(){if(!this.defaultDate){const e=[Se().format("YYYY-MM-DD")];return this.setSelected(e,!1)}let e=[];const t=this.minDate||Se().format("YYYY-MM-DD"),a=this.maxDate||Se(t).add(this.maxMonth-1,"month").format("YYYY-MM-DD");if("single"===this.mode)e=k.array(this.defaultDate)?[this.defaultDate[0]]:[Se(this.defaultDate).format("YYYY-MM-DD")];else{if(!k.array(this.defaultDate))return;e=this.defaultDate}e=e.filter((e=>Se(e).isAfter(Se(t).subtract(1,"day"))&&Se(e).isBefore(Se(a).add(1,"day")))),this.setSelected(e,!1)},setSelected(e,t=!0){this.selected=e,t&&this.$emit("monthSelected",this.selected,"tap")}}};const xe={props:{title:{type:String,default:()=>e.calendar.title},showTitle:{type:Boolean,default:()=>e.calendar.showTitle},showSubtitle:{type:Boolean,default:()=>e.calendar.showSubtitle},mode:{type:String,default:()=>e.calendar.mode},startText:{type:String,default:()=>e.calendar.startText},endText:{type:String,default:()=>e.calendar.endText},customList:{type:Array,default:()=>e.calendar.customList},color:{type:String,default:()=>e.calendar.color},minDate:{type:[String,Number],default:()=>e.calendar.minDate},maxDate:{type:[String,Number],default:()=>e.calendar.maxDate},defaultDate:{type:[Array,String,Date,null],default:()=>e.calendar.defaultDate},maxCount:{type:[String,Number],default:()=>e.calendar.maxCount},rowHeight:{type:[String,Number],default:()=>e.calendar.rowHeight},formatter:{type:[Function,null],default:()=>e.calendar.formatter},showLunar:{type:Boolean,default:()=>e.calendar.showLunar},showMark:{type:Boolean,default:()=>e.calendar.showMark},confirmText:{type:String,default:()=>e.calendar.confirmText},confirmDisabledText:{type:String,default:()=>e.calendar.confirmDisabledText},show:{type:Boolean,default:()=>e.calendar.show},closeOnClickOverlay:{type:Boolean,default:()=>e.calendar.closeOnClickOverlay},readonly:{type:Boolean,default:()=>e.calendar.readonly},showConfirm:{type:Boolean,default:()=>e.calendar.showConfirm},maxRange:{type:[Number,String],default:()=>e.calendar.maxRange},rangePrompt:{type:String,default:()=>e.calendar.rangePrompt},showRangePrompt:{type:Boolean,default:()=>e.calendar.showRangePrompt},allowSameDay:{type:Boolean,default:()=>e.calendar.allowSameDay},round:{type:[Boolean,String,Number],default:()=>e.calendar.round},monthNum:{type:[Number,String],default:3}}};var ke={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,41696,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],solarTerm:["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["日","一","二","三","四","五","六","七","八","九","十"],nStr2:["初","十","廿","卅"],nStr3:["正","二","三","四","五","六","七","八","九","十","冬","腊"],lYearDays:function(e){var t,a=348;for(t=32768;t>8;t>>=1)a+=this.lunarInfo[e-1900]&t?1:0;return a+this.leapDays(e)},leapMonth:function(e){return 15&this.lunarInfo[e-1900]},leapDays:function(e){return this.leapMonth(e)?65536&this.lunarInfo[e-1900]?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;var a=t-1;return 1==a?e%4==0&&e%100!=0||e%400==0?29:28:this.solarMonth[a]},toGanZhiYear:function(e){var t=(e-3)%10,a=(e-3)%12;return 0==t&&(t=10),0==a&&(a=12),this.Gan[t-1]+this.Zhi[a-1]},toAstro:function(e,t){return"魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯".substr(2*e-(t<[20,19,21,21,21,22,23,23,23,23,22,22][e-1]?2:0),2)+"座"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100)return-1;if(t<1||t>24)return-1;var a=this.sTermInfo[e-1900],s=[parseInt("0x"+a.substr(0,5)).toString(),parseInt("0x"+a.substr(5,5)).toString(),parseInt("0x"+a.substr(10,5)).toString(),parseInt("0x"+a.substr(15,5)).toString(),parseInt("0x"+a.substr(20,5)).toString(),parseInt("0x"+a.substr(25,5)).toString()],n=[s[0].substr(0,1),s[0].substr(1,2),s[0].substr(3,1),s[0].substr(4,2),s[1].substr(0,1),s[1].substr(1,2),s[1].substr(3,1),s[1].substr(4,2),s[2].substr(0,1),s[2].substr(1,2),s[2].substr(3,1),s[2].substr(4,2),s[3].substr(0,1),s[3].substr(1,2),s[3].substr(3,1),s[3].substr(4,2),s[4].substr(0,1),s[4].substr(1,2),s[4].substr(3,1),s[4].substr(4,2),s[5].substr(0,1),s[5].substr(1,2),s[5].substr(3,1),s[5].substr(4,2)];return parseInt(n[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;var t=this.nStr3[e-1];return t+="月"},toChinaDay:function(e){var t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,a){if(e<1900||e>2100)return-1;if(1900==e&&1==t&&a<31)return-1;if(e)s=new Date(e,parseInt(t)-1,a);else var s=new Date;var n,r=0,o=(e=s.getFullYear(),t=s.getMonth()+1,a=s.getDate(),(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())-Date.UTC(1900,0,31))/864e5);for(n=1900;n<2101&&o>0;n++)o-=r=this.lYearDays(n);o<0&&(o+=r,n--);var i=new Date,c=!1;i.getFullYear()==e&&i.getMonth()+1==t&&i.getDate()==a&&(c=!0);var f=s.getDay(),l=this.nStr1[f];0==f&&(f=7);var b=n,d=this.leapMonth(n),u=!1;for(n=1;n<13&&o>0;n++)d>0&&n==d+1&&0==u?(--n,u=!0,r=this.leapDays(b)):r=this.monthDays(b,n),1==u&&n==d+1&&(u=!1),o-=r;0==o&&d>0&&n==d+1&&(u?u=!1:(u=!0,--n)),o<0&&(o+=r,--n);var h=n,m=o+1,p=t-1,y=this.toGanZhiYear(b),g=this.getTerm(e,2*t-1),_=this.getTerm(e,2*t),D=this.toGanZhi(12*(e-1900)+t+11);a>=g&&(D=this.toGanZhi(12*(e-1900)+t+12));var S=!1,w=null;g==a&&(S=!0,w=this.solarTerm[2*t-2]),_==a&&(S=!0,w=this.solarTerm[2*t-1]);var v=Date.UTC(e,p,1,0,0,0,0)/864e5+25567+10,M=this.toGanZhi(v+a-1),$=this.toAstro(t,a);return{lYear:b,lMonth:h,lDay:m,Animal:this.getAnimal(b),IMonthCn:(u?"闰":"")+this.toChinaMonth(h),IDayCn:this.toChinaDay(m),cYear:e,cMonth:t,cDay:a,gzYear:y,gzMonth:D,gzDay:M,isToday:c,isLeap:u,nWeek:f,ncWeek:"星期"+l,isTerm:S,Term:w,astro:$}},lunar2solar:function(e,t,a,s){s=!!s;var n=this.leapMonth(e);if(this.leapDays(e),s&&n!=t)return-1;if(2100==e&&12==t&&a>1||1900==e&&1==t&&a<31)return-1;var r=this.monthDays(e,t),o=r;if(s&&(o=this.leapDays(e,t)),e<1900||e>2100||a>o)return-1;for(var i=0,c=1900;c<e;c++)i+=this.lYearDays(c);var f=0,l=!1;for(c=1;c<t;c++)f=this.leapMonth(e),l||f<=c&&f>0&&(i+=this.leapDays(e),l=!0),i+=this.monthDays(e,c);s&&(i+=r);var b=Date.UTC(1900,1,30,0,0,0),d=new Date(864e5*(i+a-31)+b),u=d.getUTCFullYear(),h=d.getUTCMonth()+1,m=d.getUTCDate();return this.solar2lunar(u,h,m)}};const Te=P({name:"u-calendar",mixins:[n,r,xe],components:{uHeader:q,uMonth:P($e,[["render",function(e,t,a,s,n,r){const f=v,h=u;return o(),i(h,{class:"u-calendar-month-wrapper",ref:"u-calendar-month-wrapper"},{default:c((()=>[(o(!0),T(Y,null,C(a.months,((e,t)=>(o(),i(h,{key:t,class:l([`u-calendar-month-${t}`]),ref_for:!0,ref:`u-calendar-month-${t}`,id:`month-${t}`},{default:c((()=>[0!==t?(o(),i(f,{key:0,class:"u-calendar-month__title"},{default:c((()=>[S(w(e.year)+"年"+w(e.month)+"月",1)])),_:2},1024)):d("v-if",!0),_(h,{class:"u-calendar-month__days"},{default:c((()=>[a.showMark?(o(),i(h,{key:0,class:"u-calendar-month__days__month-mark-wrapper"},{default:c((()=>[_(f,{class:"u-calendar-month__days__month-mark-wrapper__text"},{default:c((()=>[S(w(e.month),1)])),_:2},1024)])),_:2},1024)):d("v-if",!0),(o(!0),T(Y,null,C(e.date,((e,a)=>(o(),i(h,{class:l(["u-calendar-month__days__day",[e.selected&&"u-calendar-month__days__day__select--selected"]]),key:a,style:b([r.dayStyle(t,a,e)]),onClick:s=>r.clickHandler(t,a,e)},{default:c((()=>[_(h,{class:"u-calendar-month__days__day__select",style:b([r.daySelectStyle(t,a,e)])},{default:c((()=>[_(f,{class:l(["u-calendar-month__days__day__select__info",[e.disabled&&"u-calendar-month__days__day__select__info--disabled"]]),style:b([r.textStyle(e)])},{default:c((()=>[S(w(e.day),1)])),_:2},1032,["class","style"]),r.getBottomInfo(t,a,e)?(o(),i(f,{key:0,class:l(["u-calendar-month__days__day__select__buttom-info",[e.disabled&&"u-calendar-month__days__day__select__buttom-info--disabled"]]),style:b([r.textStyle(e)])},{default:c((()=>[S(w(r.getBottomInfo(t,a,e)),1)])),_:2},1032,["class","style"])):d("v-if",!0),e.dot?(o(),i(f,{key:1,class:"u-calendar-month__days__day__select__dot"})):d("v-if",!0)])),_:2},1032,["style"])])),_:2},1032,["style","onClick","class"])))),128))])),_:2},1024)])),_:2},1032,["class","id"])))),128))])),_:1},512)}],["__scopeId","data-v-8bb58e50"]])},data:()=>({months:[],monthIndex:0,listHeight:0,selected:[],scrollIntoView:"",scrollIntoViewScroll:"",scrollTop:0,innerFormatter:e=>e}),watch:{scrollIntoView:{immediate:!0,handler(e){}},selectedChange:{immediate:!0,handler(e){this.setMonth()}},show:{immediate:!0,handler(e){e?this.setMonth():this.scrollIntoView=""}}},computed:{innerMaxDate(){return k.number(this.maxDate)?Number(this.maxDate):this.maxDate},innerMinDate(){return k.number(this.minDate)?Number(this.minDate):this.minDate},selectedChange(){return[this.innerMinDate,this.innerMaxDate,this.defaultDate]},subtitle(){return this.months.length?`${this.months[this.monthIndex].year}年${this.months[this.monthIndex].month}月`:""},buttonDisabled(){return"range"===this.mode&&this.selected.length<=1}},mounted(){this.start=Date.now(),this.init()},emits:["confirm","close"],methods:{addUnit:y,setFormatter(e){this.innerFormatter=e},monthSelected(e,t="init"){if(this.selected=e,!this.showConfirm&&("multiple"===this.mode||"single"===this.mode||"range"===this.mode&&this.selected.length>=2)){if("init"===t)return;"tap"===t&&this.$emit("confirm",this.selected)}},init(){if(this.innerMaxDate&&this.innerMinDate&&new Date(this.innerMaxDate).getTime()<new Date(this.innerMinDate).getTime())return I();this.listHeight=5*this.rowHeight+30,this.setMonth()},close(){this.$emit("close")},confirm(){this.buttonDisabled||this.$emit("confirm",this.selected)},getMonths(e,t){const a=Se(e).year(),s=Se(e).month()+1;return 12*(Se(t).year()-a)+(Se(t).month()+1-s)+1},setMonth(){const e=this.innerMinDate||Se().valueOf(),t=this.innerMaxDate||Se(e).add(this.monthNum-1,"month").valueOf(),a=B(1,this.monthNum,this.getMonths(e,t));this.months=[];for(let s=0;s<a;s++)this.months.push({date:new Array(Se(e).add(s,"month").daysInMonth()).fill(1).map(((a,n)=>{let r=n+1;const o=Se(e).add(s,"month").date(r).day(),i=Se(e).add(s,"month").date(r).format("YYYY-MM-DD");let c="";if(this.showLunar){c=ke.solar2lunar(Se(i).year(),Se(i).month()+1,Se(i).date()).IDayCn}let f={day:r,week:o,disabled:Se(i).isBefore(Se(e).format("YYYY-MM-DD"))||Se(i).isAfter(Se(t).format("YYYY-MM-DD")),date:new Date(i),bottomInfo:c,dot:!1,month:Se(e).add(s,"month").month()+1};return(this.formatter||this.innerFormatter)(f)})),month:Se(e).add(s,"month").month()+1,year:Se(e).add(s,"month").year()})},scrollIntoDefaultMonth(e){const t=this.months.findIndex((({year:t,month:a})=>`${t}-${a=O(a)}`===e));-1!==t&&this.$nextTick((()=>{this.scrollIntoView=`month-${t}`,this.scrollIntoViewScroll=this.scrollIntoView}))},onScroll(e){const t=Math.max(0,e.detail.scrollTop);for(let a=0;a<this.months.length;a++)t>=(this.months[a].top||this.listHeight)&&(this.monthIndex=a,this.scrollIntoViewScroll=`month-${a}`)},updateMonthTop(e=[]){if(e.map(((e,t)=>{this.months[t].top=e})),!this.defaultDate){const e=Se().format("YYYY-MM");return void this.scrollIntoDefaultMonth(e)}let t=Se().format("YYYY-MM");t=k.array(this.defaultDate)?Se(this.defaultDate[0]).format("YYYY-MM"):Se(this.defaultDate).format("YYYY-MM"),this.scrollIntoDefaultMonth(t)}}},[["render",function(e,t,a,s,n,r){const l=R("uHeader"),h=R("uMonth"),y=H,g=m(p("u-button"),N),D=u,S=m(p("u-popup"),J);return o(),i(S,{show:e.show,mode:"bottom",closeable:"",onClose:r.close,round:e.round,closeOnClickOverlay:e.closeOnClickOverlay},{default:c((()=>[_(D,{class:"u-calendar"},{default:c((()=>[_(l,{title:e.title,subtitle:r.subtitle,showSubtitle:e.showSubtitle,showTitle:e.showTitle},null,8,["title","subtitle","showSubtitle","showTitle"]),_(y,{style:b({height:r.addUnit(n.listHeight)}),"scroll-y":"",onScroll:r.onScroll,"scroll-top":n.scrollTop,scrollIntoView:n.scrollIntoView},{default:c((()=>[_(h,{color:e.color,rowHeight:e.rowHeight,showMark:e.showMark,months:n.months,mode:e.mode,maxCount:e.maxCount,startText:e.startText,endText:e.endText,defaultDate:e.defaultDate,minDate:r.innerMinDate,maxDate:r.innerMaxDate,maxMonth:e.monthNum,readonly:e.readonly,maxRange:e.maxRange,rangePrompt:e.rangePrompt,showRangePrompt:e.showRangePrompt,allowSameDay:e.allowSameDay,ref:"month",onMonthSelected:r.monthSelected,onUpdateMonthTop:r.updateMonthTop},null,8,["color","rowHeight","showMark","months","mode","maxCount","startText","endText","defaultDate","minDate","maxDate","maxMonth","readonly","maxRange","rangePrompt","showRangePrompt","allowSameDay","onMonthSelected","onUpdateMonthTop"])])),_:1},8,["style","onScroll","scroll-top","scrollIntoView"]),e.showConfirm?f(e.$slots,"footer",{key:0},(()=>[_(D,{class:"u-calendar__confirm"},{default:c((()=>[_(g,{shape:"circle",text:r.buttonDisabled?e.confirmDisabledText:e.confirmText,color:e.color,onClick:r.confirm,disabled:r.buttonDisabled},null,8,["text","color","onClick","disabled"])])),_:1})]),!0):d("v-if",!0)])),_:3})])),_:3},8,["show","onClose","round","closeOnClickOverlay"])}],["__scopeId","data-v-ac6d95eb"]]),Ye=A({__name:"index",setup(e){const t=L(!1),a=()=>{t.value=!t.value};return(e,s)=>{const n=v,r=m(p("u-calendar"),Te),f=m(p("u-button"),N);return o(),i(E,null,{default:c((()=>[_(n,null,{default:c((()=>[S("发现")])),_:1}),_(r,{show:t.value,onClose:a,onConfirm:a},null,8,["show"]),_(f,{onClick:a},{default:c((()=>[S("打开日历")])),_:1})])),_:1})}}});export{Ye as default};
